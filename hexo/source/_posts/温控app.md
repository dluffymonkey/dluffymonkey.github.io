# 一、需求

## 1.1 功能项

### 1.1.1 温度

- 设置温度类别

  > 华氏温度、摄氏温度

- 设置温度

  |      | 华氏温度                            | 摄氏温度                            |
  | ---- | ------------------------------- | ------------------------------- |
  | 温度范围 | 302-464                         | 150-240                         |
  | 温度拆解 | 8个挡位                            | 8个挡位                            |
  | 拆分值  | 302、326、349、372、395、418、441、464 | 150、165、178、190、203、215、228、240 |

注：华氏温度作为温度通信基础温度，摄氏温度下需将数值转成华氏温度传输(F=C*1.8+32)

### 1.1.2 电量

- 显示电量

  > 显示当前电子烟电量

### 1.1.3 灯

- 设置亮度

  > 亮灯级别待定

  |      | 亮灯                |
  | ---- | ----------------- |
  | 范围   | 0-100             |
  | 拆分值  | 0、20、40、60、80、100 |

- 设置颜色

  > 设置灯的颜色(紫、红、白)

### 1.1.4 其他

- 震动开关设置

- 设备状态

  > 查询设备状态(温度、电量、灯颜色、灯亮度，灯颜色)

## 1.2 UI

### 1.2.1

- 主界面

  > 温度显示、调节 电量显示

- 设置页面

  > 温度单位设置
  > 灯光亮度、颜色设置
  > 震动开关设置

- 蓝牙链接提示界面

  > 提示摇摆电子烟开启蓝牙配对

# 二、约束

## 2.1 软件约束

### 2.1.1 Android约束

适配版本：5.0及以上
适配机型：小米、三星、华为

### 2.1.2 iOS约束

适配版本：iOS9及以上
适配机型：所有iPhone

### 2.1.3 其他

APP名称：tofein
启动页：不需要
[icon](https://note.youdao.com/yws/api/personal/file/793D54E28AE24D90B2DA1F9816841572?method=download&shareKey=1ab167a9792aa3206d8bb75ef82264db) ![icon](https://note.youdao.com/yws/api/personal/file/793D54E28AE24D90B2DA1F9816841572?method=download&amp;shareKey=1ab167a9792aa3206d8bb75ef82264db)

## 2.2 硬件约束

### 2.2.1 蓝牙名称

固定值：HOTT-Ble

### 2.2.2 蓝牙UUID

| 名称   | UUID   |
| ---- | ------ |
| 服务   | 0xFFF0 |
| 接收   | 0xFFF1 |
| 发送   | 0xFFF2 |

### 2.2.3 电子烟

硬件温度范围(-10，300)，精度1摄氏度

# 三、附录

## 3.1 功能报文

S：发送(send)  R：接收(receive)
报文发送应存在失败重试机制，发送失败再次发送。包括第一次发送最多发送三次报文

### 3.1.1 设置温度

| 方向   | 数据/说明 | 报文                |
| ---- | ----- | ----------------- |
| S    | 302F  | 0a 10 02 01 2e 41 |
| S    | 326F  | 0a 10 02 01 46 59 |
| S    | 349F  | 0a 10 02 01 5d 70 |
| S    | 372F  | 0a 10 02 01 74 87 |
| S    | 395F  | 0a 10 02 01 8b 9e |
| S    | 418F  | 0a 10 02 01 a2 b5 |
| S    | 441F  | 0a 10 02 01 b9 cc |
| S    | 464F  | 0a 10 02 01 d0 e3 |
| R    | 成功    | 0b 10 01 01 12    |
| R    | 失败    | 0b 10 01 00 11    |

### 3.1.2 设置灯亮度

| 方向   | 数据/说明   | 报文             |
| ---- | ------- | -------------- |
| S    | 0       | 0a 15 01 00 16 |
| S    | 20      | 0a 15 01 14 2a |
| S    | 40      | 0a 15 01 28 3e |
| S    | 60      | 0a 15 01 3c 52 |
| S    | 80      | 0a 15 01 50 66 |
| S    | 100(默认) | 0a 15 01 64 7a |
| R    | 成功      | 0b 15 01 01 17 |
| R    | 失败      | 0b 15 01 00 16 |

### 3.1.3 设置灯颜色

| 方向   | 数据/说明  | 报文             |
| ---- | ------ | -------------- |
| S    | 紫色(默认) | 0a 14 01 00 15 |
| S    | 红色     | 0a 14 01 01 16 |
| S    | 白色     | 0a 14 01 02 17 |
| R    | 成功     | 0b 14 01 01 16 |
| R    | 失败     | 0b 14 01 00 15 |

### 3.1.4 震动开关设置

| 方向   | 数据/说明 | 报文             |
| ---- | ----- | -------------- |
| S    | 开(默认) | 0a 12 01 01 14 |
| S    | 关     | 0a 12 01 00 13 |
| R    | 成功    | 0b 12 01 01 14 |
| R    | 失败    | 0b 12 01 00 13 |

### 3.1.5 查询设备状态

设备蓝牙链接成功时执行一次，初始化设备状态即可(电子烟不能手动调整设备)

| 方向   | 数据/说明            | 报文                                      |
| ---- | ---------------- | --------------------------------------- |
| S    | 查询               | 0a 11 01 00 12                          |
| R    | 温度、电量、颜色、亮灯、震动开关 | 0b 11 06 (xx xx) (xx) (xx) (xx) (xx) xx |

### 3.1.6 查询温度

蓝牙链接成功后，暂定2s查询一次(温度可能会波动)

| 方向   | 数据/说明 | 报文                |
| ---- | ----- | ----------------- |
| S    | 查询    | 0a 16 01 00 17    |
| R    | 电量    | 0b 16 02 xx xx xx |

### 3.1.7 查询电量

蓝牙链接成功后，暂定1m查询一次

| 方向   | 数据/说明 | 报文                |
| ---- | ----- | ----------------- |
| S    | 查询    | 0a 13 01 00 14    |
| R    | 电量    | 0b 13 02 xx xx xx |